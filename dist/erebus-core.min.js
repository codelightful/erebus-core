!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Erebus=t()}(this,(function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,a(e,t,"get"))}function i(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,a(e,t,"set"),n),n}function a(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function u(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var s={};function c(){return(65536*(1+Math.random())|0).toString(16).substring(1)}s.isPromise=function(t){return!!t&&(t instanceof Promise||e("function"===t.then)&&"function"==typeof t.catch)},s.trim=function(e){return"string"!=typeof e?e:e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};var f={tinyId:c,shortId:function(){return c()+c()},guid:function(){return c()+"-"+c()+"-"+c()+"-"+c()+c()}};var l={onReady:function(e){"loading"!==document.readyState?e():"function"==typeof document.addEventListener?document.addEventListener("DOMContentLoaded",e,!1):"function"==typeof document.attachEvent&&document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&e()}))}};var p={trigger:function(e){if(null!=e){if("function"!=typeof e)throw new Error("erebus.handler.trigger.invalid_function");try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.call.apply(e,[null].concat(n))}catch(e){throw new Error("erebus.handlers.trigger.function_error",e)}}},triggerAsPromise:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return null==e?Promise.resolve():"function"!=typeof e?Promise.reject("erebus.handler.trigger_promise_function.invalid_function"):new Promise((function(t,r){try{t(e.call.apply(e,[null].concat(n)))}catch(e){console.error("erebus.handlers.trigger_promise_function.function_error",e),r(e)}}))}};function d(e){if(!e||"string"!=typeof e)return[];var t=document.createElement("div");return t.innerHTML=e,n(t.childNodes)}function h(e){if(e&&e instanceof HTMLElement)for(;e.firstChild;)e.removeChild(e.firstChild)}function y(e){if(!(e&&e instanceof HTMLElement))return null;var t=e.cloneNode(!0);return 1===t.nodeType&&t.removeAttribute("id"),t}function g(e){if(!e)return null;if(e instanceof b)return e;if(e instanceof HTMLElement)return new b(e);if("string"==typeof e){var t;if("body"===e)t=document.body;else if(e.startsWith("<")&&e.endsWith(">"))t=d(e);else if(e.startsWith("#")){if(!(t=document.getElementById(e.substring(1))))throw Error("erebus.element.unknown_element_id["+e+"]")}else if(0===(t=document.querySelectorAll(e)).length)throw Error("erebus.element.unknown_selector["+e+"]");return new b(t)}}var v=new WeakMap,m=new WeakMap,b=function(){function n(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,v,{writable:!0,value:void 0}),u(this,m,{writable:!0,value:void 0}),i(this,m,!1),t instanceof HTMLElement)i(this,v,[]),o(this,v).push(t);else if(t instanceof NodeList)i(this,v,Array.from(t));else{if(!Array.isArray(t))throw Error("erebus.element.unknown_type["+e(t)+"]");i(this,v,t)}}var r,a,s;return r=n,a=[{key:"each",value:function(e){for(var t=0;t<o(this,v).length&&!1!==e(o(this,v)[t],t);t++);}},{key:"innerHTML",set:function(e){this.each((function(t){t.innerHTML=e}))}},{key:"content",value:function(e){return this.each((function(t,r){"string"==typeof e?t.innerHTML=e:e instanceof HTMLElement?(h(t),0===r?t.appendChild(e):t.appendChild(y(e))):e instanceof n&&(h(t),0===r?e.setParentNode(t):e.clone().setParentNode(t))})),this}},{key:"setParentNode",value:function(t){if(!t)return this.each((function(e){e.parentNode.removeChild(e)})),this;if("string"==typeof t)t=g(t);else if("function"!=typeof t.appendChild)throw Error("erebus.wrapper.append_to.invalid_parent["+e(t)+"]");return this.each((function(e){t.appendChild(e)})),this}},{key:"parentNode",set:function(e){this.setParentNode(e)}},{key:"appendChild",value:function(e){if("string"==typeof e){var t=d(e);this.each((function(e,n){for(var r=0;r<t.length;r++){var o=t[r];0===n?e.appendChild(o):e.appendChild(y(o))}}))}else this.each((function(t,r){e instanceof HTMLElement?0===r?t.appendChild(e):t.appendChild(y(e)):e instanceof n&&e.each((function(e){0===r?t.appendChild(e):t.appendChild(y(e))}))}));return this}},{key:"addEventListener",value:function(e,t){if(!e)throw Error("erebus.element.add_listener.null_event_name");return"function"==typeof t&&this.each((function(n){"function"==typeof n.addEventListener?n.addEventListener(e,t,!1):"function"==typeof n.attachEvent&&n.attachEvent("on"+e,t)})),this}},{key:"isHidden",get:function(){return o(this,m)}},{key:"hide",value:function(){o(this,m)||(i(this,m,!0),this.each((function(e){var t=getComputedStyle(e).getPropertyValue("display");t&&"none"!==t&&(e.originalDisplay=t),e.style.display="none"})))}},{key:"show",value:function(){this.each((function(e){var t=getComputedStyle(e).getPropertyValue("display");console.log("computedDisplay="+t),t&&"none"!==t||(e.originalDisplay?(e.style.display=e.originalDisplay,delete e.originalDisplay):e.style.display="block")}))}},{key:"clone",value:function(){var e=[];return this.each((function(t){e.push(y(t))})),new n(e)}}],a&&t(r.prototype,a),s&&t(r,s),Object.defineProperty(r,"prototype",{writable:!1}),n}(),w={},E={};function L(e,t,n){return"string"==typeof t&&t?(n||(n={}),e||(e="GET"),new Promise((function(r,o){var i=function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw Error("erebus.http.xmlhttp_error")}}}();i.onreadystatechange=function(){if(4==i.readyState||"complete"===i.readyState)if(200!==i.status){var e=new Error("http_error["+i.status+"]");e.status=i.status,e.response=i.responseText,o(e)}else{var t=i.responseText,a=function(e){var t={},n=e.getAllResponseHeaders();if(n){n=n.split("\r\n");for(var r=0;r<n.length;r++)if(n[r]){var o=n[r].split(":"),i=s.trim(o[0]).toLowerCase(),a=s.trim(o[1]);i&&a&&(t[i]=a)}}return t}(i),u=function(e){return e&&"application/json"===e["content-type"]?E.parsers.json:null}(a);if(u)try{t=u(t)}catch(e){return void o(e)}if("function"==typeof n.interceptor){var c=n.interceptor(t,a);void 0!==c&&(t=c)}r(t)}},i.open(e,t,!1!==n.async),function(e,t){if(t)for(var n in t)e.setRequestHeader(n,t[n])}(i,n.headers),"GET"!==e&&n.data?i.send(n.data):i.send()}))):Promise.reject("erebus.http.null_url")}E.parsers={},E.parsers.json=function(e){try{return JSON.parse(e)}catch(n){var t=new Error("erebus.http.json_parse_error");throw t.cause=n,t.response=e,t}},w.get=function(e,t){return L("GET",e,t)},w.post=function(e,t){return L("POST",e,t)},w.put=function(e,t){return L("PUT",e,t)},w.delete=function(e,t){return L("DELETE",e,t)},w.loadScript=function(e){return new Promise((function(t){var n=document.createElement("script");n.src=e,n.type="text/javascript",n.async=!1,n.onerror=function(){},n.onload=function(){t()},document.head.appendChild(n)}))};var T={};function C(){return navigator.language?navigator.language:navigator.browserLanguage?navigator.browserLanguage:"en-US"}function P(){return C().substr(0,2)}function _(){return T.language?T.language:P()}T.language=null,T.resources={};var S={getLocale:C,getSystemLanguage:P,setLanguage:function(e){T.language=e},getLanguage:_,setResourceBundle:function e(t,n){if(!t)return Promise.resolve();if(n||(n=_()),"function"==typeof t)return e(p.trigger(t),n);if(s.isPromise(t))return t.then((function(t){return e(t,n)})).catch((function(e){var t=Error("erebus.i18n.promise_resource_error");throw t.cause=e,t}));var r=T.resources[n];return r?Object.assign(r,t):T.resources[n]=t,Promise.resolve()},getLabel:function(e,t){var n=_(),r=T.resources[n];return r&&r[e]?r[e]:null!=t?t:e}};return console.log("Erebus Core v0.0.3"),{utils:s,random:f,events:l,handler:p,element:g,http:w,i18n:S}}));
//# sourceMappingURL=erebus-core.min.js.map
